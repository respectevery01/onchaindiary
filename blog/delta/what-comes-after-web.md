# Web 之后是什么

互联网已经从静态网页发展到我们现在习以为常的动态、交互式体验。这场变革的核心是像 AWS 和 Azure 这样的云服务提供商，它们简化了应用程序的部署和维护，提供了近乎完美的运行时间和轻松扩展的能力。

今天，我们使用的大多数应用程序都依赖于云，将数据集中存储，以便随时随地从任何设备轻松访问。云计算的弹性意味着这些应用程序可以在不费吹灰之力的情况下处理需求波动。

但云并非没有局限性。本文将探讨两种应当前互联网各种缺陷而出现的不同技术运动——Web3 和本地优先互联网。虽然这两个类别单独都不足以构建一个比今天更严格优越的互联网，但它们结合的技术和哲学见解为一种强大的新型云铺平了道路，下一代互联网的演进将建立在这样的云之上。

**本地与全局**

本地与全局之间的平衡是本文的核心主题，我们将从定义术语开始。

- 一个本地系统为每个参与者提供高度的控制权
- 一个全局系统强调强烈的共享属性

### 云端

动态、交互式且包含用户生成内容的网页让互联网变得更加有趣。像 AWS 和 Azure 这样的云服务提供商使得部署和维护这些应用变得更加容易，提供接近 100%的运行时间和按需扩展。

我们交互的大多数应用程序都在云端运行。Docker 和 Terraform 等工具使云原生应用程序能够最大限度地发挥云的优势。将数据存储在中央专用枢纽中，可以使其被世界任何地方的任何设备轻松访问，而弹性可扩展的计算意味着应用程序不必预测需求。

传统云基础设施在一定程度上是本地化的：公司通常可以通过 API 连接到此基础设施，允许他们根据自己的意愿，在想要的任何编程语言或框架中定义业务逻辑。这提供了可定制性，并因此带来了本地化。另一方面，与基于云的应用程序的每次交互都必须通过云进行，其数据存储在云端。因此，应用程序不仅在享受云的益处，还受其束缚，并且无法直接独立于它与用户交互。

![d2.png](https://img.jask.cc/file/1758362601408_d2.png)

> 在当前互联网状态下，每个用户与应用的交互都需要额外地往返云端。

此外，由数百万家公司共享的云服务提供商并不算非常全球化：谈论 AWS 的全球状态没有意义，因为数据是隔离的，互操作性有限。

事实上，AWS 不可能拥有一个具有高度互操作性的全局状态，因为彼此不信任的人将能够访问对方的状体。为了让 AWS 支持全局状态，亚马逊必须定义所有可能交互的规则和确切方式，而每个 AWS 用户现在都必须信任亚马逊正确执行所声称的规则——这根本不可能发生。

**优点**

- 云使应用程序能够根据需求弹性扩展
- 部署简单，维护也简单

**缺点**

- 无全局状态，互操作性非常弱
- 不适合用于原生金融应用——不支持克里斯·迪克森在理想化互联网的读写拥有（read-write-own）概念中的“拥有”
- 应用程序变得极其依赖云，本地存储和计算通常被逐步淘汰

## Web3

Web3 以高度拟物化的方式，旨在用去中心化基础设施栈取代云，使用许可链。总体目标是为了减少大型公司目前对其用户控制的程度和所有权。

实际上，从宏观角度来看，Web2 到 Web3 有两个核心变化：

1. 应用程序现在运行在一个去中心化、可验证的云中：可验证性是指运行区块链的验证者强制执行的严格执行规则，以及任何人都有能力验证这些规则是否正在被遵守。
2. 应用程序存在于云本身之中，而不仅仅是与之交互。用户直接与云互动：Web3 应用（智能合约）只是一个确定性机器——用户通过向验证者发送一个已签名的字节数组来与之互动。

![d3.png](https://img.jask.cc/file/1758362713515_d3.png)

> Web3 用户直接与去中心化云交谈（根据 ChatGPT 的说法，绿色是去中心化的颜色）

Web3 具有强烈的全局性，甚至可以实现跨应用的即时可组合性，并且所有状态都全局可用。

然而，它并非本地化的，因为现在的应用不过是机器中的小齿轮，将它们的所有主权都交给了运行它们的区块链。

此时，值得指出的是，局部和全局在一定程度上相互矛盾：如果某个编程模型在系统中是全局性的，例如，参与者不能选择自己的编程模型。

在某种程度上，Web3 的主要缺陷在于它过于全局化。文章后面我们将看到，下一代的网络应该只是*足够*全局化：它必须是无权限加入的，这需要一套全球法律来阻止恶意行为者加入网络并伤害其他参与者；需要有一个最小的全球状态，允许应用程序服务于网络上的任何用户，并与其他应用程序集成；最后我们需要某些全球标准，以提供类似 Web3 的互操作性，而不依赖第三方。

*通常 Web3 应用程序有相关的用户界面，但用户实际上可以直接与 Web3 应用程序交互。

**优点**

- Web3 实现真正拥有
- 强大的互操作性

**缺点**

- 应用失去自主性
- 由于区块链施加的严格要求，应用产生的生态系统变得同质化

## 本地优先的互联网

对现有网络的一种反应是本地优先软件，它旨在将数据和计算从云端移至用户设备本身，即构建 100%本地、0%全局的应用。很明显，这种完全缺乏全球功能使得本地优先互联网不足以支撑下一代的网络迭代。我们之所以在此提及它，原因有二：一方面，本地优先应用展现出我们希望未来网络具备的特性——甚至更进一步，正如我们稍后将看到的，本地优先互联网的主要技术基础也是未来网络的核心构建模块之一。

一个本地优先软件可以派上用场的领域是协作工具：这篇文章最初是在 HackMD 上撰写的，其中文档的每次更改都需要上传到云端再返回，并且冲突必须手动解决。一个本地优先的 HackMD 将不会有这些问题，它在线下和线上都能同样良好地运行，并且由于不再需要往返云端的延迟问题，其功能将得到改善。

事实上，它甚至可以完全不依赖云端或互联网；协作者可以通过蓝牙或某种 P2P 网络进行同步。

![d4.png](https://img.jask.cc/file/1758362815956_d4.png)

> 本地优先软件：无需云服务

本地优先软件完全消除了对云存储和计算的依赖。本地优先软件严格专注于用户与应用程序之间的交互，目前不考虑跨应用程序的共享状态，因此它根本不是全局性的。此外，正如这里所描述的，本地优先软件不适合具有共享状态的全球应用程序。例如，如果世界上每个人都拥有对您的 HackMD 的编辑权限，结果很可能不利于有效的协作工作。

**优点**

- 应用程序离线时和在线时工作效果一样
- 计算和存储没有外部集中化依赖
- 隐私
- 降低延迟

**缺点**

- 完全没有全局状态；既不支持互操作性也不支持所有权

## Web 的未来：走向全局本地化

到目前为止，我们看到了两种非常不同的构建更好互联网的方法：Web3（强烈全局化，完全不本地化）和本地优先互联网（完全不全局化，强烈本地化）。本节将提出如何从两者中汲取思想，创建一个既能最大化本地特性，又足够全球化以融入 Web3 的理想特征的系统。我们称之为全局本地网络（ Glocal Web），并将其底层基础设施称为全局本地云（ Glocal Cloud）。

正如我们将在本节进一步探讨的那样，为 Glocal Web 构建应用程序的开发者可以享受 Web3 无法提供的特性：他们可以自定义自己的运行时环境，可靠地产生收入，并根据带宽需求的变化弹性扩展。当我们描述 Glocal Web 足够全局化时，我们真正指的是“足够全局化以拥有与 Web3 一样强大的安全和互操作性”——未来的 Glocal Web 企业不必牺牲 Web3 提供的任何理想特性。

实现我们目标的核心技术成分是一类称为 CRDTs 的数据结构。大多数本地优先软件完全依赖于 CRDTs，正如我们将在下文简要探讨并返回到全球本地化网络之前，将清楚地表明它们如何实现本地优先应用的期望功能。

### CRDTs

无冲突复制数据类型（CRDTs）首次出现于 2011 年。顾名思义，CRDT 是一种可被多设备并发访问的复制数据结构，且不会产生冲突——例如，使用基于 CRDT 的购物清单的夫妇在购物时各自修改清单，都不会遇到同步问题。

CRDT 的一个核心特性是，所有应用于它的操作都是可交换的。也就是说，无论操作顺序如何，最终结果始终相同。这意味着，处理同一对象的参与者无需持续相互同步——他们可以任意长时间离线，一旦重新上线，只需发送操作列表（基于操作的 CRDT）、完整的新状态（基于状态的 CRDT）或状态变更列表（增量状态 CRDT）。此时，CRDT 会像魔法一样，以确定性的、无冲突的方式自动合并这些变更。

如前所述，CRDT 在本地优先软件中广泛应用。例如，本地优先的 HackMD 很可能就是基于 CRDT 构建的。

### 回归到全局本地化网络

**简而言之，其理念如下：**

1. 基于 CRDT 的最小化全局共享状态，其中每个状态元素都明确分配给某个应用程序，该应用享有对其的特殊权限（例如，只有该应用可以写入该状态片段；其他应用虽能修改，但方式受限）——这种 CRDT 遵循一套最小化的全局规则，并依赖全球标准来确保互操作性和安全性。
2. 共享 CRDT 所在的全局本地化云是去中心化的，为应用程序本身及访问应用程序的用户（作为状态的一部分）提供安全性、活跃性、无需许可和抗审查性。

有趣的是，社交媒体 Farcaster 在某种程度上是所述系统的一个特化版本，其中帖子作为 CRDT 存在，并由一个去中心化的验证器集定期对 CRDT 集合达成共识（详见此处）。

每个本地优先应用都是一个独立的 CRDT，而全球本地化网络应用则全部与一个全局 CRDT 集合进行交互。

### 本地

与 Web2 云类似，应用程序可通过 API 连接系统。不同于 Web2 的云原生应用，glocal 网络应用仅需为同步和互操作性目的定期发送和读取数据。每个应用可任意长时间保持离线状态，当状态变更最终到达时，不会改变状态 CRDT 的行为特性。

Web3 基于智能合约的应用如同机器中的齿轮，依赖底层区块链的第三方验证者来处理交易。而 glocal 网络应用则自行处理用户与应用的交互。

Glocal 网络应用可采用任何编程语言编写，其运行时环境只需满足少量最低限度的全局法则即可保障构成网络的所有应用安全性——开发者的表达自由度达到极致，同时杜绝应用在未获取有效签名的情况下擅自动用用户资金等禁止行为。

全球本地云具有强烈的本地性，应用只需利用去中心化的全球云进行同步和与其他应用的交互。

### 全球

类似于区块链，全球本地系统的强制规则和标准使应用能够安全地共享数据，提供可信的基础设施，即使是不受信任的各方也能无风险地互动，而受信任的各方则能在不依赖第三方的情况下实现更深层次的整合。

如上所述，全球本地化网络并非过度全球化；如前所述，仅实施了最低限度的全球状态、法律和标准，这使得应用程序之间能够实现安全的原子级可组合性，无需依赖第三方。

在全球本地化网络的背景下，我们将“glocal”视为由“global”的首字母与“local”完整词组合而成，这比“它与两个词的汉明距离均为 1”更能体现其属性的相对强度。

![d5.png](https://img.jask.cc/file/1758363085756_d5.png)

> 一个全局本地化的网络应用只需定期与（全球本地化）云端同步

### 全局本地化网络的优势

在此，我们探讨 Glocal 网络除已涵盖的本地化（可定制性、灵活性）与全球化（互操作性、连通性）特性之外的更多优势。

### 所有权

正如 Web3 一样，全局本地化网络使得所有权和资产能够内嵌于云端本身，人们可以自我保管资金，并自由参与全局本地化网络的金融应用，不受底层全球本地化云的限制。这一切由去中心化的全球本地化云所基于的协议来保障。

与 Web3 不同，这些金融应用能够在多个不同维度上进行创新，并拥有很大的自主权，因为全局本地化云具有极强的本地特性。

### 规模

未来互联网的全局特性不能简单地与其状态绑定，正如先前探讨的那样；为了让网络既能无许可加入又能抵御恶意行为者，全局本地化云需要运行共识协议。

共识是阻碍区块链乃至 Web3 扩展的主要瓶颈。基于 CRDT 的系统对共识要求较低，因此其性能显著优于区块链。具体而言，验证者集合无需就交易（状态变更）的全序达成一致——排序共识是共识过程中最耗费资源的环节。

此外，由于应用程序提交的状态变更无需排序，验证者可以并行传播和处理所有变更。此处的并行化意味着网络只需通过验证者增加工作节点（交易处理计算机）即可扩展吞吐量——简言之，可实现无限扩展。

全局本地化网络将允许应用程序根据需求进行扩展，正如当前 AWS 等云基础设施所做的那样。

### 速度

类似于本地优先互联网，用户可以直接与应用程序交互，无需 Web3 所需的（去中心化）云端往返，也无需当前应用程序所要求的（中心化）云端往返。

就另一种速度而言，区块链常提及区块时间，即状态更新的频率。许多应用，尤其是金融类应用，极大受益于低延迟，这意味着更新频率高。作为强全球化系统（如区块链）的一个特点是延迟较高——由于与全球分布节点达成共识，实际延迟至少为 400 毫秒。而本地化网络应用可以按任意频率更新状态，这意味着延迟可低至 1 毫秒甚至更少！

延迟是这样一个属性的例子，它在全球本地化网络（glocal web）中显然是本地的，但在 Web3 中却是全球性的。

### 离线可用性

在全局化网络（glocal web）上，构建既能在离线状态下也能在线状态下同样良好运行的应用程序是可行的，正如本地优先互联网（local-first internet）一样：应用程序根据用户输入（交易）在本地计算状态变更，并定期将变更列表提交给验证者集合（即全局化云）进行同步。

请注意，这里提到的“离线”是相对于全局云而言的：大多数用户与应用之间的交互仍将通过常规互联网进行。

### 隐私

假设有一个公共投票应用，它将参与者的投票存储为某种全局可读状态的一部分——这提供了透明度，并且对于已经使用同一云基础设施与其他应用交互的用户来说非常实用。现在，为了投票，你需要向该应用提供某种身份证明文件。

除非使用某些高级加密工具（注：存在比全球网络具有更强隐私保障的类似 Web3 协议），否则 Web3 将要求用户直接将此文档发布到区块链上，供所有人查看。

相比之下，一款全球本地化的投票应用只需在本地验证用户身份，随后即可允许其投票。

更广泛地说，全局化应用可以利用任意数量的私有数据，这些数据不与云中的其他参与者共享。

## 额外极客狙击：绝无虚言

CAP 定理指出，无许可系统必须在强最终性保证和强活性保证之间做出选择，无法同时兼得。然而，CAP 定理并非基于结果；即使两条不同的执行轨迹导致相同结果，CAP 仍视其为不同。

对于全局本地化网络，我们只关心所有节点达成相同结果：我们已经看到，基于 CRDT 的全局本地化云无需统一的总排序即可实现这一点。这意味着运行该云的两个不同节点可以以不同顺序执行同一组交易，但由于状态模型的组织方式，它们最终都将拥有相同的状态。此外，作为 CRDT 定义的一部分，已被认定为有效的交易不会被其他交易作废。

这一特性被称为逻辑单调性，它是满足 CALM（一致性即逻辑单调性）定理所需的主要假设。CALM 定理指出，逻辑单调性能够免费获得一致性（最终性）。实践中满足 CALM 定理的系统规避了 CAP 定理所呈现的不可能性：它们可以同时满足所有三个属性（我们建议对此感兴趣的读者阅读这篇文章，以深入了解 CALM 本身及其在 CAP 背景下的应用）。

全局本地化网络不会受到 CAP 定理的影响。

## 摘要

全局本地化网络基于 Web3 和本地优先软件的理念，构建了一个非拟物化、比当前云应用和体验更高效的互联网，它促进了资金和资产的无障碍流动。

它来得比你想象的要快。