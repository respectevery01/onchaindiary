# 链上加密方案：全同态加密（FHE）与可信执行环境（TEE）有何区别？

区块链技术面临着一个难题。虽然透明度对于创建去信任技术非常有益——它让全球任何有网络连接的人都能验证交易——但区块链许多最明显的应用场景，比如链上领取薪水或投票，若缺乏机密性就难以实现。几乎没有人愿意让自己的完整财务记录、投票历史，甚至扑克牌局成为公开信息。

幸运的是，新型加密技术正在为此提供解决方案。在公共区块链上，智能合约的细节（如账户余额和交易金额）可以被隐藏，这为构建一个被广泛采用的高效生态系统打开了大门。用户既能完成在中心化互联网上的一切操作，又无需将数据托管给机构，包括玩游戏、给朋友转账、链上领取薪水——所有这些都不必向公众暴露敏感信息。

目前有两种加密方法是构建这种机密链上生态系统的最佳选择。全同态加密（FHE）和可信执行环境（TEE）都是实现链上机密性的可行技术，各自具有优势与权衡。在对比这两种方法之前，让我们先分别了解它们。

## 什么是全同态加密(FHE)？

全同态加密是一种允许对加密数据执行计算并生成加密结果的加密形式。当该结果被解密时，其输出与直接在明文上执行操作的结果完全一致。

全同态加密（FHE）常被誉为加密技术的“圣杯”，因其卓越的灵活性而备受推崇——数据可存储于任何位置并保持私密性，包括链上存储且无需任何额外处理（这与零知识证明技术不同），同时还能在存储位置直接处理数据，无需向公众甚至服务器所有者暴露信息。这一特性使其极佳地维护了区块链的可组合性与灵活性。然而，当前全同态加密存在计算开销大和延迟高的问题，研究团队正积极攻克这一难题并取得显著进展，使得全同态加密在不久的将来成为极具前景的选择。

##  什么是可信执行环境(TEEs)？

可信执行环境（TEE）是处理器内部的安全飞地，可在不向系统其他部分暴露敏感数据的前提下执行计算。TEE 内的数据与代码始终保持隔离加密状态，即使整个系统被攻破，仍能确保机密性和完整性。

TEE 常被视为安全计算的实用解决方案，在安全性与性能之间实现了良好平衡。与允许在任何位置对加密数据进行计算的全同态加密（FHE）不同，TEE 依赖英特尔 SGX 或 ARM TrustZone 等专用硬件来提供安全处理环境。TEE 能以更低计算开销和延迟实现机密数据处理，使其成为当前实际部署的高效选择。但 TEE 需要用户信任硬件制造商，且已知存在某些侧信道攻击漏洞——这些挑战正是持续研究试图解决的问题，不过通过协议设计可有效缓解侧信道攻击风险。

## 全同态加密与可信执行环境对比

以下是这两种加密方法在性能、计算能力、攻击风险、可验证性、当前实用性、未来潜力及抗量子性方面的比较。

|              | TEEs                 | FHE                                  |
| ------------ | -------------------- | ------------------------------------ |
| 性能         | 快                   | 目前速度慢，计算密集型               |
| 计算         | 硬件                 | 密码学                               |
| 攻击风险     | 物理层面             | 安全多方计算（MPC）                  |
| 计算可验证性 | 通过证明             | 目前通过共识，未来用零知识证明（ZK） |
| 当前实用性   | 已投入使用           | 即将投入生产                         |
| 未来潜力     | 硬件安全性方面的改进 | 硬件发展将提高吞吐量                 |
| 抗量子性     | 不抗量子             | 抗量子                               |

> TEE 与 FHE 对比表

### 性能

可信执行环境（TEE）依赖专用硬件进行安全计算，因此能提供快速执行。相比之下，全同态加密（FHE）由于同态加密操作的复杂性，目前速度较慢且计算密集。虽然 TEE 在实时应用中表现高效，但 FHE 仍在持续演进以提升性能。

### 计算

可信执行环境（TEE）依赖专用硬件组件创建安全执行环境，而全同态加密（FHE）则通过密码学方法实现对加密数据的计算。这一根本区别意味着 TEE 需要特定的可信硬件支持，而 FHE 理论上可在任何系统上运行。

### 攻击风险

可信执行环境（TEE）已知易受侧信道攻击，攻击者可通过分析功耗、时序或其他泄漏信息来提取敏感数据。而全同态加密（FHE）虽能免疫此类攻击，但在多方计算（MPC）场景中容易遭受合谋攻击，恶意参与者可能破坏系统安全性。若缺乏可验证计算机制，MPC 网络还需依赖对计算节点正确执行运算的信任。

### 计算可验证性

可信执行环境（TEE）依赖认证机制来证明计算的完整性，这需要信任硬件提供商。相比之下，全同态加密（FHE）目前可通过共识机制实现完整性，因为计算是确定性的，并且未来可能集成零知识证明（ZK）以增强去信任验证。

### 当前实用性

可信执行环境已在各类区块链应用中广泛部署，是当下即可采用的解决方案。全同态加密虽然前景广阔，但刚刚开始进入生产应用阶段。

### 未来潜力

可信执行环境（TEE）将受益于硬件安全性的进步，解决诸如侧信道攻击等漏洞，这些问题也可以通过协议设计来缓解。同时，全同态加密（FHE）预计将实现性能提升，特别是随着专用硬件加速同态加密，使其更适用于区块链应用。

### 量子抗性

可信执行环境（TEE）本身并不具备抗量子攻击的能力，因为其安全性依赖于传统密码学原理和可信硬件。而全同态加密（FHE）基于格密码学，被认为能够抵御量子计算威胁，这使其成为后量子安全领域一种强有力的长期解决方案。

## 开启机密的链上未来

区块链机密性问题的解决方案即将到来，而全同态加密（FHE）和可信执行环境（TEE）方法对于实现这一未来至关重要。两者都是实现机密性的优秀选择，具体采用哪种技术取决于个人偏好。这两种方法在 Inco 正在开启的具备机密功能的区块链生态系统中都将发挥关键作用。